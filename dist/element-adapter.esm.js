const e=(e,t)=>r=>e*r[t],t=e=>()=>e,r=(e,t)=>{const r=typeof e,s=typeof t;if(r===s)return!0;throw new Error(`type mismatch: a(${e}) is ${r} and b(${t}) is ${s}`)};var s={">":e=>(t,s)=>{const n=e(t);return r(s,n)&&s>n},">=":e=>(t,s)=>{const n=e(t);return r(s,n)&&s>=n},"<":e=>(t,s)=>{const n=e(t);return r(s,n)&&s<n},"<=":e=>(t,s)=>{const n=e(t);return r(s,n)&&s<=n},"==":e=>(t,r)=>r===e(t)};const n={width:"w%",height:"h%"},i=Object.entries(n).reduce((e,[t,r])=>({...e,[r]:t}),{}),o=(e,t,r)=>{if(0===t.length)return;const s=document.createElement("b");s.style.position="absolute",e.appendChild(s);const n=t.reduce((e,t)=>({...e,[t]:r(s,t)}),{});return e.removeChild(s),n},a=(e,t)=>o(e,t,(e,t)=>(e.style.width="1"+t,e.getBoundingClientRect().width)),c=(e,t)=>o(e.parentNode,t,(e,t)=>{const r=i[t];e.style[r]="1%";const{[r]:s}=e.getBoundingClientRect();return s}),p=e=>["width","height"].includes(e),u=["width","height","aspect-ratio","orientation","children","characters"],d=["%","cap","ch","em","ex","ic","lh","rem","rlh","vb","vh","vi","vw","vmin","vmax","mm","Q","cm","in","pt","pc"],h=new RegExp(`^(\\d+(\\.\\d+)?)(${d.join("|")})$`),l=/^\d+(\.\d+)?(px)?$/,m=r=>{const i=r.trim().toLowerCase().split(/\s*,\s*/),o=[],a=[],c=[],p=[];for(const r of i){const i=r.split(/\s*&&\s*/),u=[];for(const r of i){const[i,o,d]=r.split(/\s+/),[,m,,w]=d.match(h)||[],g="%"===w?n[i]:w,f=g&&parseFloat(m);let b;if(p.push(i),g)("%"===w?c:a).push(g),b=e(f,g);else{const e=d.match(l)?parseFloat(d):d;b=t(e)}u.push({[i]:s[o](b)})}o.push(u)}return{query:o,units:a,percentUnits:c,watchedProperties:p}},w=({query:e,unitsMeasurements:t,props:r})=>e.some(e=>e.every(e=>{const[[s,n]]=Object.entries(e);return n(t,r[s])})),g=e=>"INPUT"===e.tagName&&!["button","submit","image"].includes(e.getAttribute("type"))||"TEXTAREA"===e.tagName,f=e=>g(e)?e.value.trim().length:e.isContentEditable?e.textContent.trim().length:0,b=e=>e.isContentEditable,v=e=>e.parentElement.isContentEditable?v(e.parentElement):e,E=({elt:e,props:t,queries:r,unitsMeasurements:s})=>{const n={...t,characters:t.characters||0,children:t.children||0};for(const[t,i]of Object.entries(r))e.classList.toggle(t,w({query:i,unitsMeasurements:s,props:n}));for(const[r,s]of Object.entries(t))e.style.setProperty("--ea-"+r,p(r)?s+"px":s)},y=e=>{const t=["width","height","orientation","aspect-ratio"];return e.some(e=>t.includes(e))},C=e=>e.includes("characters"),O=(e,t)=>C(e)&&t.isContentEditable,$=e=>e.includes("children"),q=(e,t)=>{const r={};if(y(t)){const{clientWidth:t,clientHeight:s}=e,{paddingTop:n,paddingRight:i,paddingBottom:o,paddingLeft:a}=window.getComputedStyle(e),c=t-(parseInt(a,10)+parseInt(i,10)),p=s-(parseInt(n,10)+parseInt(o,10));Object.assign(r,{width:c,height:p,orientation:c>p?"landscape":"portrait","aspect-ratio":c/p})}return C(t)&&(e.isContentEditable||g(e))&&(r.characters=f(e)),!$(t)||e.isContentEditable||g(e)||(r.children=e.childElementCount),r},j=(e,t,r=!1)=>{e.observe(t,{childList:!0,characterData:r,subtree:r})},P=`((width|height)\\s*(((>|<)=?)|==)\\s*\\d+(\\.\\d+)?(${d.join("|")}|px)|(characters|children)\\s*(((>|<)=?)|==)\\s*\\d+|aspect-ratio\\s*(((>|<)=?)|==)\\s*\\d+(\\.\\d+)?|orientation\\s*==\\s*(landscape|portrait|square))`,A=`${P}(\\s+&&\\s+${P})*`,L=new RegExp(`^\\s*${A}(\\s*,\\s*${A})*\\s*$`);export default function({target:e,queries:t={},...r}={}){(e=>{for(const t of Object.values(e))if(!t||!t.match(L))throw new Error(`invalid query "${t}"`)})(t),(({watchedProperties:e})=>{if(e&&(!Array.isArray(e)||e.length<1||!e.every(e=>u.includes(e))))throw new Error("watchedProperties must be an array with at least one of "+u.join(", "))})(r);const s=(e=>{if(!e)throw new Error("target must be provided");const t="length"in Object(e)?Array.from(e):[e];if(t.length<1)throw new Error("at least one Element must be provided as target");if(t.some(e=>!(e instanceof window.Element)))throw new Error(`target must be an Element or a list of Elements. Actual:\n[${t.map(e=>String(e)).join(", ")}]`);return t})(e),{compiledQueries:n,units:i,percentUnits:o,watchedProperties:p}=(e=>{const t={},r=[],s=[],n=[];for(const[i,o]of Object.entries(e)){const e=m(o);t[i]=e.query,r.push(...e.units),s.push(...e.percentUnits),n.push(...e.watchedProperties)}return{compiledQueries:t,units:r,percentUnits:s,watchedProperties:n}})(t);var d;return(e=>{const{ResizeObserver:t,MutationObserver:r}=window,s=new WeakMap,n={...e,propsCache:s},{elements:i,compiledQueries:o,units:p,percentUnits:d,watchedProperties:h}=e,l=y(h)&&(({propsCache:e,compiledQueries:t,units:r,percentUnits:s})=>n=>{for(const{contentRect:{width:i,height:o},target:p}of n){const n={...e.get(p),width:i,height:o,orientation:i>o?"landscape":i<o?"portrait":"square","aspect-ratio":i/o};e.set(p,n),window.requestAnimationFrame(()=>E({elt:p,props:n,queries:t,unitsMeasurements:{...a(p,r),...c(p,s)}}))}})(n),m=l&&new t(l),w=C(h)&&(({propsCache:e,compiledQueries:t,units:r,percentUnits:s})=>({target:n})=>{const i=n.value.trim().length,o=e.get(n);if(i!==o.characters){const i={...o,characters:f(n)};e.set(n,i),E({elt:n,props:i,queries:t,unitsMeasurements:{...a(n,r),...c(n,s)}})}})(n),P=($(h)||C(h)&&Array.from(i).some(b))&&(({propsCache:e,compiledQueries:t,units:r,percentUnits:s,elements:n,watchedProperties:i})=>(o,p)=>{p.disconnect();for(const{type:n,target:p}of o){const{parentElement:o}=p;if(o&&["childList","characterData"].includes(n)){let n;n=p.nodeType!==window.Node.TEXT_NODE?O(i,p)?v(p):p:v(o);const u={...e.get(n)};!$(i)||n.isContentEditable||g(n)||(u.children=n.childElementCount),O(i,n)&&(u.characters=f(n)),e.set(n,u),E({elt:n,props:u,queries:t,unitsMeasurements:{...a(n,r),...c(n,s)}})}}for(const e of n)j(p,e,O(i,e))})(n),A=P&&new r(P);for(const e of i){const t=q(e,h);s.set(e,t),m&&m.observe(e),w&&g(e)&&e.addEventListener("input",w),A&&j(A,e,O(h,e)),E({elt:e,props:t,queries:o,unitsMeasurements:{...a(e,p),...c(e,d)}})}return()=>(({elements:e,mutationObserver:t,resizeObserver:r,inputListener:s,behaviourCssClasses:n})=>{t&&t.disconnect();for(const t of e)r&&r.unobserve(t),s&&g(t)&&t.removeEventListener("input",s),t.classList.remove(...n),u.map(e=>t.style.removeProperty("--ea-"+e))})({elements:i,mutationObserver:A,resizeObserver:m,inputListener:w,behaviourCssClasses:Object.keys(o)})})({elements:s,compiledQueries:n,units:i,percentUnits:o,watchedProperties:(d=[...p,...r.watchedProperties||[]],d.length>0?Array.from(new Set(d)):d)})}
